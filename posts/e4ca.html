<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Centos7 搭建开源个人网盘Nextcloud与常用插件 | 攀岩之鹿</title><meta name="author" content="Jeremy Peng"><meta name="copyright" content="Jeremy Peng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="简介文件服务器，是一个公司最常用的服务应用，每个公司企业基本都有自己的文件服务器实，现储存分享，上传下载文件文档等功能，常见的文件服务器就是ftp服务器，但是ftp服务器的功能实在有限，且对于普通用户使用入手难度较大，又缺乏界面，对于公司的普通用户来说，确实不是一个好的文件服务器。一般ftp也只是用户服务器，网站应用等方面。 在目前的公司企业环境中，企业网盘则是一个更好的文件服务器替代方案。百度云">
<meta property="og:type" content="article">
<meta property="og:title" content="Centos7 搭建开源个人网盘Nextcloud与常用插件">
<meta property="og:url" content="https://aisk.cc/posts/e4ca.html">
<meta property="og:site_name" content="攀岩之鹿">
<meta property="og:description" content="简介文件服务器，是一个公司最常用的服务应用，每个公司企业基本都有自己的文件服务器实，现储存分享，上传下载文件文档等功能，常见的文件服务器就是ftp服务器，但是ftp服务器的功能实在有限，且对于普通用户使用入手难度较大，又缺乏界面，对于公司的普通用户来说，确实不是一个好的文件服务器。一般ftp也只是用户服务器，网站应用等方面。 在目前的公司企业环境中，企业网盘则是一个更好的文件服务器替代方案。百度云">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2019/11/10/T7Mu8Aod3egmC4Q.png">
<meta property="article:published_time" content="2020-06-20T03:00:00.000Z">
<meta property="article:modified_time" content="2023-04-02T12:32:46.050Z">
<meta property="article:author" content="Jeremy Peng">
<meta property="article:tag" content="CentOS">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="NextCloud">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2019/11/10/T7Mu8Aod3egmC4Q.png"><link rel="shortcut icon" href="/img/web-logo.png"><link rel="canonical" href="https://aisk.cc/posts/e4ca.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Jeremy Peng","link":"链接: ","source":"来源: 攀岩之鹿","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Centos7 搭建开源个人网盘Nextcloud与常用插件',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-02 20:32:46'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photo/"><i class="fa-fw fa-fw fas fa-images"></i><span> 图片</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fas fa-video"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://192.168.88.252:5001"><i class="fa-fw fas fa-folder-open"></i><span> NAS</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2019/11/10/T7Mu8Aod3egmC4Q.png')"><nav id="nav"><span id="blog-info"><a href="/" title="攀岩之鹿"><img class="site-icon" src="/img/web-logo.png"/><span class="site-name">攀岩之鹿</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photo/"><i class="fa-fw fa-fw fas fa-images"></i><span> 图片</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fas fa-video"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://192.168.88.252:5001"><i class="fa-fw fas fa-folder-open"></i><span> NAS</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Centos7 搭建开源个人网盘Nextcloud与常用插件</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-06-20T03:00:00.000Z" title="发表于 2020-06-20 11:00:00">2020-06-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-02T12:32:46.050Z" title="更新于 2023-04-02 20:32:46">2023-04-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/NextCloud/">NextCloud</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>12分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Centos7 搭建开源个人网盘Nextcloud与常用插件"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>文件服务器，是一个公司最常用的服务应用，每个公司企业基本都有自己的文件服务器实，现储存分享，上传下载文件文档等功能，常见的文件服务器就是ftp服务器，但是ftp服务器的功能实在有限，且对于普通用户使用入手难度较大，又缺乏界面，对于公司的普通用户来说，确实不是一个好的文件服务器。一般ftp也只是用户服务器，网站应用等方面。</p>
<p>在目前的公司企业环境中，企业网盘则是一个更好的文件服务器替代方案。百度云盘，相信大家基本都有用过吧，友好的界面交互，网页端，客户端都有，不需要任何命令，实现上传下载，分享等诸多功能。但是这种云盘毕竟不是自己的，很多公司对于将机密文件放在上面心存疑惑，且时不时的网盘关闭热潮也让人担心。既然如此，为何不搭建自己的网盘呢，于是就有了nextcloud。</p>
<p>对于私人网盘，市面上已经有很多的产品，很多开源半开源的云盘系统。其中最出名的就是 seafile和owncloud&#x2F;nextcloud。seafile是国人开发的，分块处理，断点上传，速度比后者要快。有社区版和企业版。社区版免费，但是功能有限，企业版要收费，功能更强大。但是社区版的功能，老实说只能满足个人使用，无法满足企业使用。而企业版要收费，费用根据公司人数不同，还需要发邮件询问。</p>
<p>像我着这种穷人，穷公司，人数不多，又不像花钱的，那么nextcloud就是最好的选择，nextcloud是owncloud的一个分支，由原创始人团队维护，是在owncloud被别的公司收购后，由创始人团队创立的新分支。就像 mysql和mariadb。nextcloud完全开源，功能强大，是外国人开发维护的。具体的与seafile等的对比，这里不详细说明了，有兴趣的百度就好。下面记录一下在centos7 服务器上搭建nextcloud的具体过程。</p>
<p> </p>
<h2 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h2><p>环境: centos8<br>nextcloud: 19.0.0 <br>selinux 关闭</p>
<ol>
<li>nextcloud是php项目，这里我使用nginx，官方文档是用apache的，有一点点具别。但不大。在下载nextcloud之前，先安装nginx和php</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 先删除系统可能自带的PHP和nginx，用来面命令查找是否有安装</span></span><br><span class="line">$ rpm -qa |grep php</span><br><span class="line">$ rpm -qa |grep nginx</span><br><span class="line"><span class="comment"># 强制删除软件包，软件包全称就是上面通过rpm -qa 查询到的软件包全名</span></span><br><span class="line">$ rpm -e --nodeps &#123;软件包全称&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment"># 安装yum的epel源，这里推荐用阿里云的镜像安装，包更全。</span></span><br><span class="line">$ rpm -ivh https://mirrors.aliyun.com/epel/epel-release-latest-7.noarch.rpm</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 安装nginx</span></span><br><span class="line">$ yum install -y nginx</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 安装php的源</span></span><br><span class="line">$ rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 安装php已经会用到扩展</span></span><br><span class="line">$ yum install -y php70w-devel php70w-pear php70w-pecl php70w-gd php70w-opcache php70w-cli php70w-pdo php70w-process php70w-pecl-apcu php70w-mcrypt php70w-mysql php70w-fpm php70w-pecl-memcached php70w-common php70w-xml php70w-mbstring php70w-pecl-igbinary</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 检查是否安装成功</span></span><br><span class="line">$ nginx -v</span><br><span class="line">nginx version: nginx/1.12.2</span><br><span class="line">$ php -v</span><br><span class="line">PHP 7.0.30 (cli) (built: Apr 28 2018 08:14:08) ( NTS )</span><br><span class="line">Copyright (c) 1997-2017 The PHP Group</span><br><span class="line">Zend Engine v3.0.0, Copyright (c) 1998-2017 Zend Technologies</span><br><span class="line">    with Zend OPcache v7.0.30, Copyright (c) 1999-2017, by Zend Technologies</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>nextcloud 还需要数据库，这里我使用的mysql，mysql提前安装好或使用已有的数据库服务器，具体安装安装方式可参考我另一篇博文: 《CentOS7.2 安装mysql，并配置自动启动和远程访问》。在mysql种创建一个新的databse用于nextcloud使用.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在装有mysql的服务器上执行</span></span><br><span class="line">$ mysql -u root -p</span><br><span class="line">&gt; create database nextcloud_db;</span><br><span class="line"><span class="comment"># 授权给自定义用户，这里以用户名：nextclouduser，密码：nextcloudpasswd，代替。</span></span><br><span class="line">&gt; grant all privileges on nextcloud_db.* to nextclouduser@localhost identified by <span class="string">&#x27;nextcloudpasswd&#x27;</span>;</span><br><span class="line">&gt; flush privileges;</span><br></pre></td></tr></table></figure>

<p>3.  为nextcloud 生成自签名ssl证书</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /etc/nginx/cert/    <span class="comment"># 没有则创建此文件夹</span></span><br><span class="line">$ openssl req -new -x509 -days 365 -nodes -out /etc/nginx/cert/nextcloud.crt -keyout /etc/nginx/cert/nextcloud.key</span><br><span class="line"><span class="comment"># 会出现下面的选项需要填写，可以随便填。</span></span><br><span class="line">Country Name (2 letter code) [XX]:cn                                 <span class="comment"># 国家</span></span><br><span class="line">State or Province Name (full name) []:guangdong                      <span class="comment"># 省份</span></span><br><span class="line">Locality Name (eg, city) [Default City]:guangzhou                    <span class="comment"># 地区名字</span></span><br><span class="line">Organization Name (eg, company) [Default Company Ltd]:Amos           <span class="comment"># 公司名</span></span><br><span class="line">Organizational Unit Name (eg, section) []:Technology                 <span class="comment"># 部门</span></span><br><span class="line">Common Name (eg, your name or your server<span class="string">&#x27;s hostname) []:Amos        # CA主机名</span></span><br><span class="line"><span class="string">Email Address []:Amos@Amos.com                                       # Email地址</span></span><br><span class="line"><span class="string"># 修改证书和文件夹权限</span></span><br><span class="line"><span class="string">$ chmod 600 /etc/nginx/cert/*</span></span><br><span class="line"><span class="string">$ chmod 700 /etc/nginx/cert</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>下载nextcloud，并配置php和nginx</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 下载nextcloud，官网地址为: https://nextcloud.com/install/#instructions-server</span></span><br><span class="line">$ <span class="built_in">cd</span> /usr/local/src</span><br><span class="line">$ yum install -y wget unzip</span><br><span class="line">$ wget https://download.nextcloud.com/server/releases/nextcloud-13.0.2.zip    <span class="comment"># 下载</span></span><br><span class="line">$ unzip nextcloud-13.0.2.zip    <span class="comment"># 解压</span></span><br><span class="line">$ <span class="built_in">mv</span> nextcloud /usr/share/nginx/html/    <span class="comment"># 移动到指定文件夹内</span></span><br><span class="line">$ <span class="built_in">cd</span> /usr/share/nginx/html/nextcloud     <span class="comment"># 进行nextcloud 目录中</span></span><br><span class="line">$ <span class="built_in">mkdir</span> data    <span class="comment"># 创建数据文件夹</span></span><br><span class="line">$ <span class="built_in">chown</span> nginx:nginx -R nextcloud/    <span class="comment"># 将nextcloud文件授权给nginx</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 配置php-fpm</span></span><br><span class="line">$ vim /etc/php-fpm.d/www.conf</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">user = nginx                                   //将用户和组都改为nginx</span><br><span class="line">group = nginx</span><br><span class="line">listen = 127.0.0.1:9000</span><br><span class="line"><span class="built_in">env</span>[HOSTNAME] = <span class="variable">$HOSTNAME</span>                     //将以下几行，去掉注释</span><br><span class="line"><span class="built_in">env</span>[PATH] = /usr/local/bin:/usr/bin:/bin</span><br><span class="line"><span class="built_in">env</span>[TMP] = /tmp</span><br><span class="line"><span class="built_in">env</span>[TMPDIR] = /tmp</span><br><span class="line"><span class="built_in">env</span>[TEMP] = /tmp</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># 为php创建session文件夹</span></span><br><span class="line">$ <span class="built_in">mkdir</span> -p /var/lib/php/session</span><br><span class="line">$ <span class="built_in">chown</span> nginx:nginx -R /var/lib/php/session/</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># 配置nginx</span></span><br><span class="line">$ <span class="built_in">cd</span> /etc/nginx/conf.d/</span><br><span class="line">$ vim nextcloud.conf</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">upstream php-handler &#123;</span><br><span class="line">    server 127.0.0.1:9000;</span><br><span class="line">    <span class="comment">#server unix:/var/run/php5-fpm.sock;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name localhost;</span><br><span class="line">    <span class="comment"># enforce https</span></span><br><span class="line">    rewrite ^(.*)$ https://$host<span class="variable">$1</span> permanent;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl;</span><br><span class="line">    server_name localhost;</span><br><span class="line"> </span><br><span class="line">    ssl_certificate /etc/nginx/cert/nextcloud.crt;</span><br><span class="line">    ssl_certificate_key /etc/nginx/cert/nextcloud.key;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Add headers to serve security related headers</span></span><br><span class="line">    <span class="comment"># Before enabling Strict-Transport-Security headers please read into this</span></span><br><span class="line">    <span class="comment"># topic first.</span></span><br><span class="line">    add_header Strict-Transport-Security <span class="string">&quot;max-age=15768000;</span></span><br><span class="line"><span class="string">    includeSubDomains; preload;&quot;</span>;</span><br><span class="line">    add_header X-Content-Type-Options nosniff;</span><br><span class="line">    add_header X-Frame-Options <span class="string">&quot;SAMEORIGIN&quot;</span>;</span><br><span class="line">    add_header X-XSS-Protection <span class="string">&quot;1; mode=block&quot;</span>;</span><br><span class="line">    add_header X-Robots-Tag none;</span><br><span class="line">    add_header X-Download-Options noopen;</span><br><span class="line">    add_header X-Permitted-Cross-Domain-Policies none;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Path to the root of your installation</span></span><br><span class="line">    root /usr/share/nginx/html/nextcloud/;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    location = /robots.txt &#123;</span><br><span class="line">        allow all;</span><br><span class="line">        log_not_found off;</span><br><span class="line">        access_log off;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment"># The following 2 rules are only needed for the user_webfinger app.</span></span><br><span class="line">    <span class="comment"># Uncomment it if you&#x27;re planning to use this app.</span></span><br><span class="line">    <span class="comment">#rewrite ^/.well-known/host-meta /public.php?service=host-meta last;</span></span><br><span class="line">    <span class="comment">#rewrite ^/.well-known/host-meta.json /public.php?service=host-meta-json</span></span><br><span class="line">    <span class="comment"># last;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    location = /.well-known/carddav &#123;</span><br><span class="line">      <span class="built_in">return</span> 301 <span class="variable">$scheme</span>://<span class="variable">$host</span>/remote.php/dav;</span><br><span class="line">    &#125;</span><br><span class="line">    location = /.well-known/caldav &#123;</span><br><span class="line">      <span class="built_in">return</span> 301 <span class="variable">$scheme</span>://<span class="variable">$host</span>/remote.php/dav;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment"># set max upload size</span></span><br><span class="line">    client_max_body_size 10240M;    <span class="comment"># 上传文件最大限制，php.ini中也要修改，最后优化时会提及。</span></span><br><span class="line">    fastcgi_buffers 64 4K;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Disable gzip to avoid the removal of the ETag header</span></span><br><span class="line">    gzip on;</span><br><span class="line">    gzip_vary on;</span><br><span class="line">    gzip_comp_level 4;</span><br><span class="line">    gzip_min_length 256;</span><br><span class="line">    gzip_proxied expired no-cache no-store private no_last_modified no_etag auth;</span><br><span class="line">    gzip_types application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml application/vnd.geo+json application/vnd.ms-fontobject application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/vtt text/x-component text/x-cross-domain-policy;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Uncomment if your server is build with the ngx_pagespeed module</span></span><br><span class="line">    <span class="comment"># This module is currently not supported.</span></span><br><span class="line">    <span class="comment">#pagespeed off;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    error_page 403 /core/templates/403.php;</span><br><span class="line">    error_page 404 /core/templates/404.php;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    location / &#123;</span><br><span class="line">        rewrite ^ /index.php<span class="variable">$uri</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)/ &#123;</span><br><span class="line">        deny all;</span><br><span class="line">    &#125;</span><br><span class="line">    location ~ ^/(?:\.|autotest|occ|issue|indie|db_|console) &#123;</span><br><span class="line">        deny all;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    location ~ ^/(?:index|remote|public|cron|core/ajax/update|status|ocs/v[12]|updater/.+|ocs-provider/.+|core/templates/40[34])\.php(?:$|/) &#123;</span><br><span class="line">        include fastcgi_params;</span><br><span class="line">        fastcgi_split_path_info ^(.+\.php)(/.*)$;</span><br><span class="line">        fastcgi_param SCRIPT_FILENAME $document_root<span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">        fastcgi_param PATH_INFO <span class="variable">$fastcgi_path_info</span>;</span><br><span class="line">        fastcgi_param HTTPS on;</span><br><span class="line">        <span class="comment">#Avoid sending the security headers twice</span></span><br><span class="line">        fastcgi_param modHeadersAvailable <span class="literal">true</span>;</span><br><span class="line">        fastcgi_param front_controller_active <span class="literal">true</span>;</span><br><span class="line">        fastcgi_pass php-handler;</span><br><span class="line">        fastcgi_intercept_errors on;</span><br><span class="line">        fastcgi_request_buffering off;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    location ~ ^/(?:updater|ocs-provider)(?:$|/) &#123;</span><br><span class="line">        try_files <span class="variable">$uri</span>/ =404;</span><br><span class="line">        index index.php;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Adding the cache control header for js and css files</span></span><br><span class="line">    <span class="comment"># Make sure it is BELOW the PHP block</span></span><br><span class="line">    location ~* \.(?:css|js)$ &#123;</span><br><span class="line">        try_files <span class="variable">$uri</span> /index.php$uri$is_args<span class="variable">$args</span>;</span><br><span class="line">        add_header Cache-Control <span class="string">&quot;public, max-age=7200&quot;</span>;</span><br><span class="line">        <span class="comment"># Add headers to serve security related headers (It is intended to</span></span><br><span class="line">        <span class="comment"># have those duplicated to the ones above)</span></span><br><span class="line">        <span class="comment"># Before enabling Strict-Transport-Security headers please read into</span></span><br><span class="line">        <span class="comment"># this topic first.</span></span><br><span class="line">        add_header Strict-Transport-Security <span class="string">&quot;max-age=15768000;includeSubDomains; preload;&quot;</span>;</span><br><span class="line">        add_header X-Content-Type-Options nosniff;</span><br><span class="line">        add_header X-Frame-Options <span class="string">&quot;SAMEORIGIN&quot;</span>;</span><br><span class="line">        add_header X-XSS-Protection <span class="string">&quot;1; mode=block&quot;</span>;</span><br><span class="line">        add_header X-Robots-Tag none;</span><br><span class="line">        add_header X-Download-Options noopen;</span><br><span class="line">        add_header X-Permitted-Cross-Domain-Policies none;</span><br><span class="line">        <span class="comment"># Optional: Don&#x27;t log access to assets</span></span><br><span class="line">        access_log off;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    location ~* \.(?:svg|gif|png|html|ttf|woff|ico|jpg|jpeg)$ &#123;</span><br><span class="line">        try_files <span class="variable">$uri</span> /index.php$uri$is_args<span class="variable">$args</span>;</span><br><span class="line">        <span class="comment"># Optional: Don&#x27;t log access to other assets</span></span><br><span class="line">        access_log off;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># 将nginx原配置中80端口的配置删除</span></span><br><span class="line">$ vim /etc/nginx/nginx.conf</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">server &#123;          <span class="comment"># 将80端口的server整个删除，应该我们在上面nextcloud.conf中已经配置了，这里不删除的话会导致冲突不生效。</span></span><br><span class="line">    listen 80;</span><br><span class="line">...</span><br><span class="line">  &#125;</span><br><span class="line">--------------------------------------------------------</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>启动nginx和php-fpm</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ nginx -t    <span class="comment"># 检查nginx配置是否正确，出现下面输入则正确。</span></span><br><span class="line">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok</span><br><span class="line">nginx: configuration file /etc/nginx/nginx.conf <span class="built_in">test</span> is successful</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 启动并设为开机启动 nginx，php-fpm</span></span><br><span class="line">$ systemctl start nginx</span><br><span class="line">$ systemctl <span class="built_in">enable</span> nginx</span><br><span class="line">$ systemctl start php-fpm</span><br><span class="line">$ systemctl <span class="built_in">enable</span> php-fpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置防火墙，开放http和https的端口。</span></span><br><span class="line">$ firewall-cmd --add-port=80/tcp --permanent</span><br><span class="line">$ firewall-cmd --add-port=443/tcp --permanent</span><br><span class="line">$ firewall-cmd --reload</span><br></pre></td></tr></table></figure>
<p>PS： 这里我的selinux是关闭的，如果selinux没有关闭，则执行下面命令关闭selinux</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ setenforce 0    <span class="comment"># 关闭selinux</span></span><br><span class="line">$ vim /etc/selinux/config    <span class="comment"># 修改配置，永久关闭。</span></span><br><span class="line">------------------------------------------------------</span><br><span class="line">SELINUX=disabled</span><br><span class="line">------------------------------------------------------</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>访问网页界面，完成安装。访问搭建nextcloud服务器的ip地址。（如果有域名就访问域名）<br>按照实际情况进行配置，配置完成后，点击安装完成。上图中mysql的主机名，使用上面我们自己的数据库服务器地址和端口</li>
</ol>
<p>7. 性能优化，进入主界面后，右上角自己头像，点击设置，基本设置：<br>第一项就有 安全及设置警告，这里会有配置错误提示，优化提示等。根据提示进行优化：<br>① 修改php.ini 文件，添加如下配置：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ vim /etc/php.ini</span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line">[PHP]    <span class="comment"># 在[PHP] 以下添加如下配置</span></span><br><span class="line">opcache.enable=1</span><br><span class="line">opcache.enable_cli=1</span><br><span class="line">opcache.interned_strings_buffer=8</span><br><span class="line">opcache.max_accelerated_files=10000</span><br><span class="line">opcache.memory_consumption=128</span><br><span class="line">opcache.save_comments=1</span><br><span class="line">opcache.revalidate_freq=1</span><br><span class="line">...</span><br><span class="line">upload_max_filesize = 10240M    <span class="comment"># 上传文件最大大小，可以自定义修改，默认为512M</span></span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line"> </span><br><span class="line">$ vim /etc/nginx/nginx.d/nextcloud.conf</span><br></pre></td></tr></table></figure>

<p>② 设置缓存后端，可以使用redis，memcache。单机或集群模式都可以。不同的配置方式可以参考官方文档。</p>
<p>这里我直接单机安装并配置使用memcache。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ yum install -y memcache</span><br><span class="line">$ vim /etc/sysconfig/memcached</span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line">PORT=<span class="string">&quot;11211&quot;</span>    <span class="comment"># 端口</span></span><br><span class="line">USER=<span class="string">&quot;memcached&quot;</span>    <span class="comment"># 用户</span></span><br><span class="line">MAXCONN=<span class="string">&quot;1024&quot;</span>    <span class="comment"># 最大链接数</span></span><br><span class="line">CACHESIZE=<span class="string">&quot;2048&quot;</span>    <span class="comment"># 最大内存，单位M</span></span><br><span class="line">OPTIONS=<span class="string">&quot;&quot;</span></span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 修改nextcloud的config配置文件，添加memcached缓存配置</span></span><br><span class="line">$ vim /usr/share/nginx/html/nextcloud/config/config.php</span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line"><span class="string">&#x27;memcache.local&#x27;</span> =&gt; <span class="string">&#x27;\OC\Memcache\APCu&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;memcache.distributed&#x27;</span> =&gt; <span class="string">&#x27;\OC\Memcache\Memcached&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;memcached_servers&#x27;</span> =&gt; array(</span><br><span class="line">   array(<span class="string">&#x27;localhost&#x27;</span>, 11211),</span><br><span class="line">     ),</span><br><span class="line">-----------------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<p>③ 重启nginx和php-fpm，是配置生效</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ systemctl start memcached</span><br><span class="line">$ systemctl <span class="built_in">enable</span> memcached</span><br><span class="line">$ systemctl restart nginx</span><br><span class="line">$ systemctl restart php-fpm</span><br></pre></td></tr></table></figure>

<p>④ 设置后台任务，cron执行。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ vim /etc/crontab    <span class="comment"># 修改cron配置文件，添加如下配置</span></span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line">*/15 * * * * -u nginx /usr/bin/php -f /usr/share/nginx/html/nextcloud/cron.php</span><br><span class="line">---------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<ol start="8">
<li>配置邮件服务器</li>
</ol>
<p>在设置 –&gt; 其他设置 中，配置smtp服务器。并进行测试，收到邮件则为OK。</p>
<ol start="9">
<li>到此，nextcloud已经安装完成。除此之外，nextcloud还有很多常用插件，用于拓展功能，包括官方的或个人的，点击右上角个人头像–&gt;应用</li>
</ol>
<p>在这里可以直接点击安装启动应用。非常方便。本身安装时便会自带有一些应用，这里推荐几个需要手动安装的常用应用：</p>
<p>①Announcement center  管理员可以发公告</p>
<p>②Circles 圈子，每个人都可以建立加入圈子，实现圈子的文件共享</p>
<p>③Group folders 组文件夹</p>
<p>④File access control 文件访问控制</p>
<p>⑤Impersonate 管理员可以模拟用户，可以以用户登陆到他们的网盘，可以看到个人用户的文件，这个有点不太隐私。</p>
<p>。。。</p>
<p>当然，还有很多有趣的应用，等你自己去发现。</p>
<p>OK，到此，nextcloud的搭建已经完成。自己去不断使用，不断探索功能吧。</p>
<p> </p>
<p>PS：在设置中还会一直有一些报错，虽然按照要求进行配置了，却还是报错，这就在暂且忽略掉吧</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://aisk.cc">Jeremy Peng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://aisk.cc/posts/e4ca.html">https://aisk.cc/posts/e4ca.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://aisk.cc" target="_blank">攀岩之鹿</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CentOS/">CentOS</a><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/NextCloud/">NextCloud</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2019/11/10/T7Mu8Aod3egmC4Q.png" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/462d.html" title="Linux 系统修复"><img class="cover" src="https://file.crazywong.com/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Linux 系统修复</div></div></a></div><div class="next-post pull-right"><a href="/posts/fa9f.html" title="Linux 存储扩容，分区扩容"><img class="cover" src="https://i.loli.net/2019/11/10/T7Mu8Aod3egmC4Q.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux 存储扩容，分区扩容</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/e3a7.html" title="Centos7双网卡绑定配置 bonding"><img class="cover" src="https://i.loli.net/2019/11/10/T7Mu8Aod3egmC4Q.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-29</div><div class="title">Centos7双网卡绑定配置 bonding</div></div></a></div><div><a href="/posts/9014.html" title="Linux系统单用户模式"><img class="cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-02</div><div class="title">Linux系统单用户模式</div></div></a></div><div><a href="/posts/efc.html" title="Linux系统安装之后，如何调节CPU性能策略"><img class="cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-25</div><div class="title">Linux系统安装之后，如何调节CPU性能策略</div></div></a></div><div><a href="/posts/d931.html" title="Linux安全加固措施方案之密码加固"><img class="cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-08</div><div class="title">Linux安全加固措施方案之密码加固</div></div></a></div><div><a href="/posts/fa9f.html" title="Linux 存储扩容，分区扩容"><img class="cover" src="https://i.loli.net/2019/11/10/T7Mu8Aod3egmC4Q.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-10</div><div class="title">Linux 存储扩容，分区扩容</div></div></a></div><div><a href="/posts/76b2.html" title="Linux磁盘分区并挂载"><img class="cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-20</div><div class="title">Linux磁盘分区并挂载</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83"><span class="toc-number">2.</span> <span class="toc-text">安装环境</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Jeremy Peng</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">我的其它站点：<a href="https://aisk.cc/" target="_blank" rel="noopener">aisk.cc</a>、<a href="https://baize.cc/" target="_blank" rel="noopener">baize.cc</a><br>留下运维点滴记忆，悠悠岁月慢慢回味。</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>